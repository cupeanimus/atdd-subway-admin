# ATDD

## 2단계 - 인수 테스트 리팩토링

### 요구 사항
* API 변경 대응하기
    * 노선 생성 시 종점역(상행, 하행) 정보를 요청 파라미터에 함께 추가하기
        * 두 종점역은 구간의 형태로 관리되어야 함
    * 노선 조회 시 응답 결과에 역 목록 추가하기
        * 상행역 부터 하행역 순으로 정렬되어야 함

### 작업 순서

* [x] 노선 생성 리팩토링( 종점역 정보 추가)
* [x] 두 종점역을 관리하는 구간 형태 추가
* [x] 노선 조회 리팩토링(응답 결과에 역 목록 추가)
* [x] 정렬 확인

#### 피드백 반영

* [x] sections의 콜렉션 타입 Set으로 변경(현재 솔팅도 필요 없으니 중복 제거 특징이 유리)
* [x] 컨트롤러에서 비즈니스 로직 서비스로 이관
* [x] 구간과 역의 연관관계 수정
* [x] 구간 생성 패턴 수정

## 3단계 - 구간 추가 기능
* 기능 구현 전 인수 테스트 작성
* 예외 케이스 처리 인수 테스트 작성

### 작업 순서

* [X] 구간 등록 인수 테스트 생성
* [X] 구간 등록 기능 구현
    * 상행역, 하행역을 비교하여 구간을 추가한다
* [X] 구간 등록 요청 구현        
* [ ] 리팩토링
    * 환승을 고려하지 않아 구간과 역의 관계가 ManyToOne의 관계로 설계하였으나, 여러 라인에 존재하는 것으로 ManyToMany로 의도가 변경.
        -> 따라서 중간 객체를 만들어 ManyToOne, OneToMany 관계로 변경한다 
        -> 현재 단계에서 역을통해 라인을 검색하는 요구사항이 없다. 역을 검색하여 라인으로 넘어가는 경우라면 LineStation이 필요하지만 현재단계에선 관계를 재 설정하여도 사용하지 않기 때문에 보류한다.
      
        






